const fs = require("fs")

module.exports = {
  plugin() {
    // just using codegen as a convenient way to watch graphql files here
    const fileContents = fs
      .readdirSync(`${__dirname}/src/graphql`)
      .map((file) => fs.readFileSync(`${__dirname}/src/graphql/${file}`).toString())

    fs.writeFileSync(
      `${__dirname}/src/schema-definitions.ts`,
      [
        "// This file is generated by graphql-codegen",
        "// DO NOT EDIT THIS FILE DIRECTLY",
        `export const typeDefs = ${JSON.stringify(fileContents, null, 2)}`
      ].join("\n") + "\n"
    )
  }
}
